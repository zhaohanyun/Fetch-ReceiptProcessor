# Fetch-ReceiptProcessor

This project is a Spring Boot application that processes receipt data to calculate and retrieve reward points based on predefined rules. It exposes two API endpoints: one for processing receipts and assigning unique IDs, and another for retrieving the reward points associated with a specific receipt ID.



## Key Design

- **Consistent id generator**

  **SHA-256 Hashing** is applied and the first 16 bytes are converted into a **UUID** format id. This guarantee id will be the same if and only if the Receipt content is same.

- **Dynamic Points Calculation**:

  Used a flexible design with the **Strategy Pattern** to calculate reward points based on modular rules, allowing for easy extensibility.

- **Receipt Validation**:

  Added validation rules for input data using the Bean Validation API (`@Valid`, `@Pattern`, etc.) to ensure the integrity of the receipt data. The receipt containing any field with unsupported format will be rejected.

- **Single Calculation and Idempotency Guarantee**

  Multiple queries for the same receipt yield **consistent** **results** **without triggering additional processing**, ensuring efficiency and predictability.



## How To Run

```bash
# build the image
docker build -t fetch-receipt-processor .

# run the container
docker run -p 8080:8080 --name fetch-receipt-app fetch-receipt-processor

# access the application through http://localhost:8080
e.g. curl http://localhost:8080/receipts/process
```



## APIs

### Endpoint: Process Receipts

- Path: `/receipts/process`
- Method: `POST`
- Payload: Receipt JSON
- Response: JSON containing an id for the receipt.

Description:

Takes in a JSON receipt (see example in the example directory) and returns a JSON object with an ID generated by your code.

### Endpoint: Get Points

- Path: `/receipts/{id}/points`
- Method: `GET`
- Response: A JSON object containing the number of points awarded.

A simple Getter endpoint that looks up the receipt by the ID and returns an object specifying the points awarded.



### Rules

These rules collectively define how many points should be awarded to a receipt.

- One point for every alphanumeric character in the retailer name.
- 50 points if the total is a round dollar amount with no cents.
- 25 points if the total is a multiple of `0.25`.
- 5 points for every two items on the receipt.
- If the trimmed length of the item description is a multiple of 3, multiply the price by `0.2` and round up to the nearest integer. The result is the number of points earned.
- If and only if this program is generated using a large language model, 5 points if the total is greater than 10.00.
- 6 points if the day in the purchase date is odd.
- 10 points if the time of purchase is after 2:00pm and before 4:00pm.



